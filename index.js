(()=>{"use strict";function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}var t=function(){function t(e,n,a,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this._tabsContainer=document.querySelector(e),this._tabsContentContainer=document.querySelector(n),this._tabsList=Array.from(this._tabsContainer.children),this._tabsContentList=Array.from(this._tabsContentContainer.children),this._activeTabSelector=a,this._activeTabContentSelector=r,this._activeTab=this._tabsContainer.querySelector(".".concat(this._activeTabSelector)),this._activeTabContent=this._tabsContentContainer.querySelector(".".concat(this._activeTabContentSelector))}var n,a;return n=t,(a=[{key:"_changeTab",value:function(e){this._activeTab.classList.remove(this._activeTabSelector),this._activeTabContent.classList.remove(this._activeTabContentSelector),this._activeTab=e,this._activeTabContent=this._tabsContentContainer.querySelector("#".concat(e.id)),this._activeTab.classList.add(this._activeTabSelector),this._activeTabContent.classList.add(this._activeTabContentSelector)}},{key:"setListeners",value:function(){var e=this;this._tabsList.forEach((function(t){t.addEventListener("click",(function(t){t.preventDefault(),e._changeTab(t.target)}))}))}}])&&e(n.prototype,a),Object.defineProperty(n,"prototype",{writable:!1}),t}();function n(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}var a=function(){function e(t){var n=t.baseUrl,a=t.key,r=t.headers;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._baseUrl=n,this._apiKey=a,this._headers=r}var t,a;return t=e,(a=[{key:"_checkResponse",value:function(e){return e.ok?e.json():Promise.reject(e)}},{key:"getTrends",value:function(){return fetch("".concat(this._baseUrl,"/trending?api_key=").concat(this._apiKey,"&limit=32"),{headers:this._headers}).then(this._checkResponse)}},{key:"getSearch",value:function(e){return fetch("".concat(this._baseUrl,"/search?api_key=").concat(this._apiKey,"&q=").concat(e,"&limit=32"),{headers:this._headers}).then(this._checkResponse)}},{key:"getRandomGif",value:function(){var e=this;return fetch("".concat(this._baseUrl,"/random?api_key=").concat(this._apiKey),{headers:this._headers}).then((function(t){return e._checkResponse(t)}))}},{key:"uploadGif",value:function(e,t){var n=this,a=new Headers;a.append("Content-Type","application/x-www-form-urlencoded");var r=new URLSearchParams;r.append("file","".concat(t)),r.append("tags","".concat(e)),console.log("".concat(t));var o={method:"POST",headers:a,body:r,redirect:"follow"};fetch("https://upload.giphy.com/v1/gifs?api_key=".concat(this._apiKey),o).then((function(e){return n._checkResponse(e)}))}}])&&n(t.prototype,a),Object.defineProperty(t,"prototype",{writable:!1}),e}();function r(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}var o=function(){function e(t){var n=t.templateSelector,a=t.gifsListSelector,r=t.gifsItemSelector;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._templateSelector=n,this._gifsListSelector=a,this._gifsItemSelector=r}var t,n;return t=e,(n=[{key:"_getTemplate",value:function(){return document.querySelector(this._templateSelector).content.querySelector(".gifs__item").cloneNode(!0)}},{key:"generate",value:function(e){return this._gif=this._getTemplate(),this._gif.src=e,this._gif}}])&&r(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function i(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}var c=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._containerElement=document.querySelector(t),this._renderer=n}var t,n;return t=e,(n=[{key:"add",value:function(e){this._containerElement.append(e)}},{key:"renderItems",value:function(e){var t=this;e.forEach((function(e){t._renderer(e)}))}},{key:"replaceGif",value:function(e){this._containerElement.replaceChild(e,this._containerElement.firstChild)}}])&&i(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}(),s=document.querySelector(".button_type_random-gif"),l=document.querySelector(".button_type_search"),u=document.querySelector(".search__input"),f=document.querySelector(".search__status"),h=(document.querySelector(".search__form"),document.querySelector(".gifs_type_search"));new t(".navigation",".tabs-content","navigation__link_active","tab-content_active").setListeners();var d=new o({templateSelector:".template",gifsListSelector:".gifs",gifsItemSelector:".gifs__item"}),_=new c(".gifs_type_trends",(function(e){var t=v(e.images.original.url);_.add(t)})),p=new c(".gifs_type_search",(function(e){var t=v(e.images.original.url);p.add(t)}));function v(e){return d.generate(e)}var y=new a({baseUrl:"https://api.giphy.com/v1/gifs",key:"LgKQAIWNj0vz4nfwGHULAscH7a9nyP5R",headers:{"Content-Type":"application/json"}}),m=new c(".gifs_type_random");function g(){y.getRandomGif().then((function(e){var t=v(e.data.images.original.url);t.classList.add("gifs__item_type_random"),m.replaceGif(t)})).catch((function(e){alert("".concat(e,", Что-то пошло не так, попробуйте обновить страницу"))})).finally((function(){s.textContent="Get another random gif"}))}g(),s.addEventListener("click",(function(){s.textContent="One moment...",g()})),document.querySelector(".button_type_add");var b=document.querySelector(".search__input_type_add"),S=document.querySelector(".add__input"),w=document.querySelector(".add__input_uploaded"),C=document.querySelector(".add");new c(".add",(function(e){var t=v(e.images.original.url);p.add(t)})),S.addEventListener("change",(function(e){var t=this.files[0],n=document.createElement("img");n.classList.add("obj"),n.file=t,document.querySelector(".preview").appendChild(n),console.log(t);var a,r=new FileReader;r.onload=(a=n,function(e){a.src=e.target.result}),r.readAsDataURL(t);var o=document.querySelector("img"),i=document.querySelector("input[type=file]").files[0],c=new FileReader;c.addEventListener("load",(function(){o.src=c.result}),!1),i&&console.log(c.result)}),!1),C.addEventListener("submit",(function(e){e.preventDefault(),console.log(b.value),console.log(S.value),new FileReader,console.log(document.querySelector(".obj")),y.uploadGif(b.value,document.querySelector(".obj").src).then((function(e){console.log(e)})).catch((function(e){console.log(e),alert("".concat(e,", Что-то пошло не так, попробуйте обновить страницу"))})).finally((function(){C.reset(),w.textContent=""}))}));var k=C.querySelector(".button_type_remove");k.addEventListener("click",(function(e){e.preventDefault(),k.parentElement.reset(),w.textContent=""})),y.getTrends().then((function(e){_.renderItems(e.data)})).catch((function(e){console.log(e),alert("".concat(e,", Что-то пошло не так, попробуйте обновить страницу"))})),l.addEventListener("click",(function(e){e.preventDefault(),h.contains(document.querySelector(".gifs__item"))&&Array.from(h.querySelectorAll(".gifs__item")).forEach((function(e){e.remove()})),f.classList.add("search__status_active"),f.textContent="Please wait...",y.getSearch(u.value).then((function(e){0===e.data.length?f.textContent="Sorry, no gifs with your name...":(f.classList.remove("search__status_active"),p.renderItems(e.data),u.value="")})).catch((function(e){alert("".concat(e,", Что-то пошло не так, попробуйте обновить страницу"))}))}))})();